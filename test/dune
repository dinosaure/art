(executable
 (name test)
 (modules test)
 (libraries art alcotest))

(executable
 (name persistent)
 (modules persistent)
 (libraries mmap base64 rowex rowex.persistent unix alcotest bos))

(executable
 (name rb)
 (modules rb fiber)
 (libraries bos rresult fmt.tty logs.fmt fmt mmap base64 rowex
   rowex.persistent unix))

(executable
 (name test_ring)
 (modules test_ring)
 (libraries unix))

(rule
 (alias runtest)
 (package art)
 (deps
  (:test test.exe))
 (action
  (run %{test} --color=always)))

(rule
 (alias runtest)
 (package rowex)
 (deps
  (:test persistent.exe))
 (action
  (run %{test} --color=always)))

(rule
 (alias runtest)
 (package rowex)
 (deps
  (:test test_ring.exe)
  (:rb rb.exe))
 (action
  (run %{test})))
